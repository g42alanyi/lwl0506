<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arix Christmas Experience</title>
    <style>
        body { margin: 0; background: #010805; overflow: hidden; font-family: 'Georgia', serif; }
        
        /* é–€çš„å ´æ™¯å®¹å™¨ */
        #door-scene {
            position: absolute; width: 100vw; height: 100vh;
            z-index: 999; display: flex; justify-content: center; align-items: center;
            background: radial-gradient(circle, #1a1a1a 0%, #000 100%);
            transition: opacity 1.2s ease-in-out;
        }

        /* é–€çš„æ¨£å¼ */
        .door-frame {
            position: relative; width: 260px; height: 420px;
            perspective: 1500px; cursor: pointer;
        }

        .door {
            position: absolute; width: 100%; height: 100%;
            background: #4a2c1d; border: 4px solid #FFD700;
            border-radius: 5px; transform-origin: left;
            transition: transform 1.8s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
        }

        /* å°è²“ Emoji */
        .cat-icon { font-size: 80px; filter: drop-shadow(0 0 10px rgba(255,215,0,0.3)); }
        
        /* æ–‡å­— */
        .brand { color: #FFD700; letter-spacing: 5px; margin-top: 20px; font-weight: bold; }

        /* é–‹é–€å‹•ç•« */
        .door.is-open { transform: rotateY(-115deg); }
        .scene-hidden { opacity: 0; pointer-events: none; }

        /* 3D å®¹å™¨ */
        #three-canvas-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
    </style>
</head>
<body>

    <div id="door-scene">
        <div class="door-frame" id="door-trigger">
            <div id="the-door" class="door">
                <div class="cat-icon">ğŸ±</div>
                <div class="brand">ARIX</div>
                <div style="color: #FFD700; font-size: 10px; margin-top: 5px; opacity: 0.7;">CLICK TO ENTER</div>
            </div>
        </div>
    </div>

    <div id="three-canvas-container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        // --- A. é–‹é–€äº’å‹•é‚è¼¯ ---
        const trigger = document.getElementById('door-trigger');
        const door = document.getElementById('the-door');
        const sceneOverlay = document.getElementById('door-scene');

        trigger.addEventListener('click', () => {
            console.log("Door clicked!"); // é™¤éŒ¯ç”¨
            door.classList.add('is-open');
            
            // å»¶é²ä¸€æ®µæ™‚é–“å¾Œè®“é–€å®Œå…¨æ¶ˆå¤±ï¼Œéœ²å‡ºå¾Œé¢çš„ 3D
            setTimeout(() => {
                sceneOverlay.classList.add('scene-hidden');
            }, 800);
        });

        // --- B. Three.js 3D è–èª•æ¨¹é‚è¼¯ ---
        let scene, camera, renderer, treeGroup, snowParticles;

        function init3D() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x010805);
            
            camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 3, 10);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            document.getElementById('three-canvas-container').appendChild(renderer.domElement);

            // å…‰æº
            const ambient = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambient);
            const point = new THREE.PointLight(0xffd700, 1.5);
            point.position.set(5, 5, 5);
            scene.add(point);

            // å»ºç«‹è–èª•æ¨¹
            treeGroup = new THREE.Group();
            const material = new THREE.MeshStandardMaterial({ 
                color: 0x043927, 
                roughness: 0.3, 
                metalness: 0.6 
            });

            for(let i = 0; i < 6; i++) {
                const geo = new THREE.ConeGeometry(2 - i * 0.3, 1.5, 12);
                const layer = new THREE.Mesh(geo, material);
                layer.position.y = i * 0.8 - 2;
                treeGroup.add(layer);
            }
            scene.add(treeGroup);

            // é‡‘ç®”é›ªèŠ±
            const snowGeo = new THREE.BufferGeometry();
            const snowCount = 1200;
            const positions = new Float32Array(snowCount * 3);
            for(let i = 0; i < snowCount * 3; i++) {
                positions[i] = (Math.random() - 0.5) * 20;
            }
            snowGeo.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            const snowMat = new THREE.PointsMaterial({ 
                color: 0xFFD700, 
                size: 0.04, 
                transparent: true, 
                opacity: 0.8 
            });
            snowParticles = new THREE.Points(snowGeo, snowMat);
            scene.add(snowParticles);

            animate();
        }

        function animate() {
            requestAnimationFrame(animate);
            
            // æ¨¹æ—‹è½‰
            if(treeGroup) treeGroup.rotation.y += 0.01;
            
            // é›ªèŠ±é£„è½
            if(snowParticles) {
                const pos = snowParticles.geometry.attributes.position.array;
                for(let i = 1; i < pos.length; i += 3) {
                    pos[i] -= 0.02;
                    if(pos[i] < -5) pos[i] = 10;
                }
                snowParticles.geometry.attributes.position.needsUpdate = true;
            }

            renderer.render(scene, camera);
        }

        // ç›£è½è¦–çª—ç¸®æ”¾
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // å•Ÿå‹• 3D
        try {
            init3D();
        } catch(e) {
            console.error("Three.js init failed: ", e);
        }
    </script>
</body>
</html>
